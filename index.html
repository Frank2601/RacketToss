<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Digitale Racket Toss â€“ Animatie</title>
<style>
body{font-family:Arial,sans-serif;background:#f4f4f4;padding:20px;text-align:center}
textarea{width:320px;height:150px}
button{margin:8px;padding:10px 18px;font-size:16px;cursor:pointer}
.players-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:6px;margin-top:15px}
.player-item{background:white;padding:6px 10px;border-radius:6px;text-align:left}
.cards{margin-top:25px;display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:15px}
.card-slot{background:white;border-radius:10px;padding:10px;box-shadow:0 0 6px rgba(0,0,0,.15);min-height:200px;display:flex;flex-direction:column;justify-content:space-between}
.card{width:100%;height:130px;perspective:800px}
.card-inner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform 1s}
.card.flip .card-inner{transform:rotateY(180deg)}
.card-face{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:28px;font-weight:bold;border:2px solid #333}
.card-back{background:white;display:flex;justify-content:center;align-items:center} .card-back img{max-width:70%;opacity:0.9}
.card-front{background:white;transform:rotateY(180deg)}
.rood{color:darkred;border-color:darkred}
.zwart{color:black;border-color:black}
.suit{font-size:36px}
.inactive{opacity:.4}
.courts{margin-top:30px;display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:15px}
.court{background:white;padding:15px;border-radius:10px;box-shadow:0 0 6px rgba(0,0,0,.15)}
.error{color:red;margin-top:10px}
</style>
</head>
<body>
<img src="https://storage.knltb.club/logos/2964cfd3-8868-4df8-8c35-c703493af3ea.png" alt="TV TeVer logo" style="max-width:160px;margin-bottom:10px;"><h1>ðŸŽ¾ Digitale Racket Toss â€“ Kaarten draaien</h1>
<p>Kaarten verschijnen Ã©Ã©n voor Ã©Ã©n met vertraging</p>
<textarea id="names" placeholder="Naam 1\nNaam 2\nNaam 3..."></textarea><br>
<button onclick="loadPlayers()">ðŸ“‹ Spelers laden</button>
<div id="players" class="players-list"></div>
<button onclick="dealAnimated()">ðŸŽ¡ Draaien</button>
<div id="message" class="error"></div>
<div id="cards" class="cards"></div>
<div id="courts" class="courts"></div>
<script>
const ranks=['A','K','Q','J'];
const rankNames={A:'Aas',K:'Heer',Q:'Vrouw',J:'Boer'};
let allPlayers=[];
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}}
function loadPlayers(){const c=document.getElementById('players');c.innerHTML='';allPlayers=document.getElementById('names').value.split('\n').map(n=>n.trim()).filter(Boolean);if(allPlayers.length<4){msg('Minimaal 4 spelers');return}msg('');allPlayers.forEach(n=>{const d=document.createElement('div');d.className='player-item';d.innerHTML=`<label><input type=checkbox checked data-name="${n}"> ${n}</label>`;c.appendChild(d)});renderEmpty();document.getElementById('courts').innerHTML=''}
function msg(t){document.getElementById('message').textContent=t}
function activePlayers(){return[...document.querySelectorAll('#players input:checked')].map(c=>c.dataset.name)}
function buildDeck(count){const d=[];ranks.forEach(r=>{d.push({rank:r,color:'Zwart',suit:'â™ '});d.push({rank:r,color:'Zwart',suit:'â™£'});d.push({rank:r,color:'Rood',suit:'â™¥'});d.push({rank:r,color:'Rood',suit:'â™¦'})});shuffle(d);return d.slice(0,count)}
function renderEmpty(){const c=document.getElementById('cards');c.innerHTML='';allPlayers.forEach(n=>{const s=document.createElement('div');s.className='card-slot inactive';s.innerHTML=`<strong>${n}</strong><div class="card"><div class="card-inner"><div class="card-face card-back"><img src="https://storage.knltb.club/logos/2964cfd3-8868-4df8-8c35-c703493af3ea.png" alt="TeVer"></div><div class="card-face card-front"></div></div></div>`;c.appendChild(s)})}
async function dealAnimated(){
    const act = activePlayers();
    if (act.length % 4 !== 0 || act.length === 0) {
      msg('Selecteer een veelvoud van 4 spelers');
      return;
    }
    msg('');

    const deck = buildDeck(act.length);
    renderEmpty();

    const slots = [...document.querySelectorAll('.card-slot')];
    const order = act.map((name, i) => ({ name, card: deck[i] }));
    shuffle(order);

    const assignments = {};

    for (let i = 0; i < order.length; i++) {
      const { name, card } = order[i];
      assignments[name] = card;

      const idx = allPlayers.indexOf(name);
      const slot = slots[idx];
      const front = slot.querySelector('.card-front');

      front.className = `card-face card-front ${card.color === 'Rood' ? 'rood' : 'zwart'}`;
      front.innerHTML = `<div>${card.rank}</div><div class="suit">${card.suit}</div>`;

      await new Promise(r => setTimeout(r, 700));
      slot.classList.remove('inactive');
      slot.querySelector('.card').classList.add('flip');
    }

    await new Promise(r => setTimeout(r, 800));
    renderCourts(assignments);
  }
    msg('');

    const deck = buildDeck(act.length);
    renderEmpty();

    const slots = [...document.querySelectorAll('.card-slot')];
    const order = act.map((name, i) => ({ name, card: deck[i] }));
    shuffle(order); // ðŸ”€ willekeurige onthul-volgorde

    const assignments = {};

    for (let i = 0; i < order.length; i++) {
      const { name, card } = order[i];
      assignments[name] = card;

      const idx = allPlayers.indexOf(name);
      const slot = slots[idx];
      const front = slot.querySelector('.card-front');

      front.className = `card-face card-front ${card.color === 'Rood' ? 'rood' : 'zwart'}`;
      front.innerHTML = `<div>${card.rank}</div><div class="suit">${card.suit}</div>`;

      await new Promise(r => setTimeout(r, 700));
      slot.classList.remove('inactive');
      slot.querySelector('.card').classList.add('flip');
    }

    renderCourts(assignments);
  }
function renderCourts(assignments){const c=document.getElementById('courts');c.innerHTML='';const g={};Object.entries(assignments).forEach(([n,card])=>{if(!g[card.rank])g[card.rank]=[];g[card.rank].push({n,card})});let i=1;Object.entries(g).forEach(([r,grp])=>{if(grp.length===4){const z=grp.filter(p=>p.card.color==='Zwart');const rd=grp.filter(p=>p.card.color==='Rood');const d=document.createElement('div');d.className='court';d.innerHTML=`<h3>Baan ${i++} â€“ ${rankNames[r]}</h3><p class=zwart>â¬› ${z[0].n} & ${z[1].n}</p><p><strong>vs</strong></p><p class=rood>ðŸŸ¥ ${rd[0].n} & ${rd[1].n}</p>`;c.appendChild(d)}})}
</script>
</body>
</html>
